import os
import hashlib

def calculate_hash(file_path):
    sha256_hash = hashlib.sha256()
    with open(file_path, "rb") as f:
        for byte_block in iter(lambda: f.read(4096), b""):
            sha256_hash.update(byte_block)
    return sha256_hash.hexdigest()

def extract_strings(file_path):
    strings = []
    with open(file_path, "rb") as f:
        data = f.read()
        strings = [s.decode('utf-8', 'ignore') for s in data.split(b'\x00') if len(s) > 4]
    return strings

if __name__ == "__main__":
    sample_path = "../data/sample_malware.exe"
    print(f"SHA-256: {calculate_hash(sample_path)}")
    print("Strings:")
    for s in extract_strings(sample_path):
        print(s)
